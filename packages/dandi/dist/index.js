"use strict";(()=>{var N=Object.defineProperty;var V=(s,t)=>{for(var e in t)N(s,e,{get:t[e],enumerable:!0})};var z=(s,t,e)=>{if(!t.has(s))throw TypeError("Cannot "+e)};var i=(s,t,e)=>(z(s,t,"read from private field"),e?e.call(s):t.get(s)),r=(s,t,e)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,e)},a=(s,t,e,n)=>(z(s,t,"write to private field"),n?n.call(s,e):t.set(s,e),e);var T={};V(T,{Asset:()=>m,Dandiset:()=>b,get:()=>P,getAll:()=>E,getAsset:()=>v,getAssetInfo:()=>S,getAssets:()=>R,getAssetsUrl:()=>U,utils:()=>j});var j={};V(j,{getBase:()=>y,getInfo:()=>$,getInfoURL:()=>h,getInstance:()=>B,getJSON:()=>c,getLatestVersion:()=>w,paginate:()=>_});var k={main:"api.dandiarchive.org",staging:"api-staging.dandiarchive.org"},D=k;var w=async(s,t)=>{let e=await y(s,t);if(e){let n=e.most_recent_published_version?.version;if(n)return n;if(e.draft_version?.status==="Valid")return e.draft_version?.version}else return null},B=s=>typeof s=="string"?D[s]:D.main,c=s=>fetch(s).then(t=>t.json()),L=(s,t)=>`https://${B(t)}/api/dandisets/${s}`,y=(s,t)=>c(L(s,t)),h=(s,t)=>`${L(s,t?.instance)}/versions/${t?.version?t.version:"draft"}`,$=async(s,t)=>{let e=t?.version??await w(s,t?.instance);if(e)return c(h(s,{...t,version:e}))},_=async s=>{let t=[];if(s.results&&t.push(...s.results),s.next){let e=await c(s.next);t.push(...await _(e))}return t};var d,f,l,O,m=class{constructor(t,e,n="main"){r(this,d,void 0);r(this,f,void 0);r(this,l,{});r(this,O,t=>{Object.assign(this,t),this.asset_id=t.asset_id});e&&typeof e=="object"&&!(e instanceof String)?i(this,O).call(this,e):this.asset_id=e,a(this,d,n),a(this,f,t)}async get(t=i(this,f),e=this.asset_id,n=i(this,d)){a(this,f,t),a(this,d,n),this.asset_id=e;let o=await v(i(this,f),this.asset_id,i(this,d));return o&&Object.assign(this,o),o}async getInfo(t){return i(this,l)||a(this,l,await S(i(this,f),this.asset_id,{...t,instance:i(this,d)})),i(this,l)}};d=new WeakMap,f=new WeakMap,l=new WeakMap,O=new WeakMap;var v=async(s,t,e)=>{let n=h(s,e),o=await c(`${n}/${t}`);return new m(s,o,e?.instance)},S=async(s,t,e)=>{let n=h(s,e);return await c(`${n}/${t}/info`)};var p,I,u,g,x,A,b=class{constructor(t,e="main"){r(this,p,"main");r(this,I,{});r(this,u,{});r(this,g,{});r(this,x,!1);r(this,A,t=>{a(this,I,t),Object.assign(this,t),this.identifier=t.identifier});t&&typeof t=="object"&&!(t instanceof String)?i(this,A).call(this,t):this.identifier=t,a(this,p,e)}async get(t=this.identifier){if(t!==this.identifier){this.identifier=t,a(this,u,{}),a(this,g,{});let e=await y(this.identifier,i(this,p));e&&Object.assign(this,e)}return i(this,I)}async getInfo(t={}){return Object.keys(i(this,u)).length===0&&a(this,u,await $(this.identifier,{...t,instance:i(this,p)})),i(this,u)}async getAsset(t){return i(this,g)[t]||(i(this,g)[t]=await v(this.identifier,t,{instance:i(this,p)})),i(this,g)[t]}async getAssets(t={}){return i(this,x)||((await R(this.identifier,{...t,instance:i(this,p)}))?.forEach(n=>i(this,g)[n.asset_id]=n),a(this,x,!0)),i(this,g)}};p=new WeakMap,I=new WeakMap,u=new WeakMap,g=new WeakMap,x=new WeakMap,A=new WeakMap;var U=(s,t)=>`${h(s,t)}/assets`,R=async(s,t)=>{let e=t?.version??await w(s,t?.instance);if(e){let n=`${U(s,{...t,version:e})}`,o=await c(n);return(await _(o)).map(J=>new m(s,J,t?.instance))}},E=async s=>{let t=`https://${B(s)}/api/dandisets`,e=await c(t);return(await _(e)).map(o=>new b(o,s))},P=async(s,t)=>{let e=await y(s,t);return e?new b(e,t):null};typeof globalThis.dandi<"u"?Object.assign(globalThis.dandi,T):globalThis.dandi=T;})();
//# sourceMappingURL=index.js.map
