"use strict";var D=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var E=Object.prototype.hasOwnProperty;var V=(s,t)=>{for(var e in t)D(s,e,{get:t[e],enumerable:!0})},P=(s,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of k(t))!E.call(s,a)&&a!==e&&D(s,a,{get:()=>t[a],enumerable:!(n=N(t,a))||n.enumerable});return s};var q=s=>P(D({},"__esModule",{value:!0}),s);var z=(s,t,e)=>{if(!t.has(s))throw TypeError("Cannot "+e)};var i=(s,t,e)=>(z(s,t,"read from private field"),e?e.call(s):t.get(s)),o=(s,t,e)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,e)},r=(s,t,e,n)=>(z(s,t,"write to private field"),n?n.call(s,e):t.set(s,e),e);var H={};V(H,{Asset:()=>y,Dandiset:()=>b,get:()=>G,getAll:()=>F,getAsset:()=>O,getAssetInfo:()=>S,getAssets:()=>R,getAssetsUrl:()=>U,utils:()=>j});module.exports=q(H);var j={};V(j,{getBase:()=>l,getInfo:()=>$,getInfoURL:()=>h,getInstance:()=>B,getJSON:()=>c,getLatestVersion:()=>x,paginate:()=>_});var C={main:"api.dandiarchive.org",staging:"api-staging.dandiarchive.org"},T=C;var x=async(s,t)=>{let e=await l(s,t);if(e){let n=e.most_recent_published_version?.version;if(n)return n;if(e.draft_version?.status==="Valid")return e.draft_version?.version}else return null},B=s=>typeof s=="string"?T[s]:T.main,c=s=>fetch(s).then(t=>t.json()),L=(s,t)=>`https://${B(t)}/api/dandisets/${s}`,l=(s,t)=>c(L(s,t)),h=(s,t)=>`${L(s,t?.instance)}/versions/${t?.version?t.version:"draft"}`,$=async(s,t)=>{let e=t?.version??await x(s,t?.instance);if(e)return c(h(s,{...t,version:e}))},_=async s=>{let t=[];if(s.results&&t.push(...s.results),s.next){let e=await c(s.next);t.push(...await _(e))}return t};var d,f,m,v,y=class{constructor(t,e,n="main"){o(this,d,void 0);o(this,f,void 0);o(this,m,{});o(this,v,t=>{Object.assign(this,t),this.asset_id=t.asset_id});e&&typeof e=="object"&&!(e instanceof String)?i(this,v).call(this,e):this.asset_id=e,r(this,d,n),r(this,f,t)}async get(t=i(this,f),e=this.asset_id,n=i(this,d)){r(this,f,t),r(this,d,n),this.asset_id=e;let a=await O(i(this,f),this.asset_id,i(this,d));return a&&Object.assign(this,a),a}async getInfo(t){return i(this,m)||r(this,m,await S(i(this,f),this.asset_id,{...t,instance:i(this,d)})),i(this,m)}};d=new WeakMap,f=new WeakMap,m=new WeakMap,v=new WeakMap;var O=async(s,t,e)=>{let n=h(s,e),a=await c(`${n}/${t}`);return new y(s,a,e?.instance)},S=async(s,t,e)=>{let n=h(s,e);return await c(`${n}/${t}/info`)};var p,I,u,g,w,A,b=class{constructor(t,e="main"){o(this,p,"main");o(this,I,{});o(this,u,{});o(this,g,{});o(this,w,!1);o(this,A,t=>{r(this,I,t),Object.assign(this,t),this.identifier=t.identifier});t&&typeof t=="object"&&!(t instanceof String)?i(this,A).call(this,t):this.identifier=t,r(this,p,e)}async get(t=this.identifier){if(t!==this.identifier){this.identifier=t,r(this,u,{}),r(this,g,{});let e=await l(this.identifier,i(this,p));e&&Object.assign(this,e)}return i(this,I)}async getInfo(t={}){return Object.keys(i(this,u)).length===0&&r(this,u,await $(this.identifier,{...t,instance:i(this,p)})),i(this,u)}async getAsset(t){return i(this,g)[t]||(i(this,g)[t]=await O(this.identifier,t,{instance:i(this,p)})),i(this,g)[t]}async getAssets(t={}){return i(this,w)||((await R(this.identifier,{...t,instance:i(this,p)}))?.forEach(n=>i(this,g)[n.asset_id]=n),r(this,w,!0)),i(this,g)}};p=new WeakMap,I=new WeakMap,u=new WeakMap,g=new WeakMap,w=new WeakMap,A=new WeakMap;var U=(s,t)=>`${h(s,t)}/assets`,R=async(s,t)=>{let e=t?.version??await x(s,t?.instance);if(e){let n=`${U(s,{...t,version:e})}`,a=await c(n);return(await _(a)).map(J=>new y(s,J,t?.instance))}},F=async s=>{let t=`https://${B(s)}/api/dandisets`,e=await c(t);return(await _(e)).map(a=>new b(a,s))},G=async(s,t)=>{let e=await l(s,t);return e?new b(e,t):null};0&&(module.exports={Asset,Dandiset,get,getAll,getAsset,getAssetInfo,getAssets,getAssetsUrl,utils});
//# sourceMappingURL=index.node.js.map
